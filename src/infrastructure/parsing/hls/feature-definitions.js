/**
 * @typedef {object} Feature
 * @property {string} name
 * @property {'Core Streaming' | 'Timeline & Segment Management' | 'Live & Dynamic' | 'Advanced Content' | 'Client Guidance & Optimization' | 'Accessibility & Metadata'} category
 * @property {string} desc
 * @property {string} isoRef
 * @property {number} version - The HLS protocol version where this feature was introduced.
 * @property {boolean} [isDynamic] - True if the feature can appear dynamically in a live stream.
 * @property {number} [complexityScore] - Weighted score (1-5).
 */

/** @type {Feature[]} */
export const hlsFeatureDefinitions = [
    {
        name: 'Presentation Type',
        category: 'Core Streaming',
        desc: 'Defines if the stream is live (`EVENT`) or on-demand (`VOD`).',
        isoRef: 'HLS 2nd Ed: 4.4.3.5',
        version: 1,
        complexityScore: 1,
    },
    {
        name: 'Multivariant Playlist',
        category: 'Core Streaming',
        desc: 'The manifest is an HLS multivariant playlist that references multiple variant streams at different bitrates.',
        isoRef: 'HLS 2nd Ed: 4.4.6.2',
        version: 1,
        complexityScore: 1,
    },
    {
        name: 'Discontinuity',
        category: 'Core Streaming',
        desc: '[Ad Insertion] The presentation contains discontinuity tags, commonly used for Server-Side Ad Insertion (SSAI).',
        isoRef: 'HLS 2nd Ed: 4.4.4.3',
        version: 1,
        isDynamic: true,
        complexityScore: 3,
    },
    {
        name: 'Content Protection',
        category: 'Core Streaming',
        desc: 'Indicates that the content is encrypted using AES-128 or SAMPLE-AES.',
        isoRef: 'HLS 2nd Ed: 4.4.4.4',
        version: 1,
        isDynamic: true,
        complexityScore: 3,
    },
    {
        name: 'Session Keys',
        category: 'Core Streaming',
        desc: 'Allows encryption keys to be specified in the Multivariant Playlist via #EXT-X-SESSION-KEY, enabling clients to preload keys for faster startup.',
        isoRef: 'HLS 2nd Ed: 4.4.6.5',
        version: 1,
        isDynamic: true,
        complexityScore: 2,
    },
    {
        name: 'Fragmented MP4 Segments',
        category: 'Core Streaming',
        desc: 'Content is structured using fMP4 segments instead of MPEG-2 Transport Stream (TS), indicated by #EXT-X-MAP.',
        isoRef: 'HLS 2nd Ed: 4.4.4.5',
        version: 5,
        complexityScore: 2,
    },
    {
        name: 'Byte-Range Segments',
        category: 'Timeline & Segment Management',
        desc: 'Media Segments are defined as sub-ranges of a larger resource using the #EXT-X-BYTERANGE tag.',
        isoRef: 'HLS 2nd Ed: 4.4.4.2',
        version: 4,
        complexityScore: 2,
    },
    {
        name: 'Discontinuity Sequence',
        category: 'Timeline & Segment Management',
        desc: 'Uses #EXT-X-DISCONTINUITY-SEQUENCE to allow synchronization between different renditions of the same variant stream.',
        isoRef: 'HLS 2nd Ed: 4.4.3.3',
        version: 1,
        isDynamic: true,
        complexityScore: 3,
    },
    {
        name: 'Gap Segments',
        category: 'Timeline & Segment Management',
        desc: 'Uses EXT-X-GAP to signal the absence of media data, for example during a temporary encoder outage.',
        isoRef: 'HLS 2nd Ed: 4.4.4.7',
        version: 8,
        isDynamic: true,
        complexityScore: 3,
    },
    {
        name: 'Independent Segments',
        category: 'Timeline & Segment Management',
        desc: 'The playlist uses #EXT-X-INDEPENDENT-SEGMENTS, indicating that all media samples in a segment can be decoded without information from other segments.',
        isoRef: 'HLS 2nd Ed: 4.4.2.1',
        version: 1,
        complexityScore: 2,
    },
    {
        name: 'Date Ranges / Timed Metadata',
        category: 'Live & Dynamic',
        desc: '[Ad Insertion] Carries timed metadata via #EXT-X-DATERANGE, which is the primary mechanism for SCTE-35 ad signaling in HLS.',
        isoRef: 'HLS 2nd Ed: 4.4.5.1',
        version: 1,
        isDynamic: true,
        complexityScore: 3,
    },
    {
        name: 'Program Date Time',
        category: 'Live & Dynamic',
        desc: 'Associates media segments with an absolute date and time, enabling wall-clock synchronization.',
        isoRef: 'HLS 2nd Ed: 4.4.4.6',
        version: 1,
        complexityScore: 2,
    },
    {
        name: 'Interstitials',
        category: 'Live & Dynamic',
        desc: '[Ad Insertion] Uses HLS Interstitials (EXT-X-DATERANGE with CLASS="com.apple.hls.interstitial") for separate ad asset scheduling.',
        isoRef: 'HLS 2nd Ed: Appendix D',
        version: 10,
        isDynamic: true,
        complexityScore: 5,
    },
    {
        name: 'Low-Latency HLS',
        category: 'Live & Dynamic',
        desc: 'Uses modern HLS features for reduced latency, such as Partial Segments (EXT-X-PART), Preload Hinting (EXT-X-PRELOAD-HINT), and Server Control.',
        isoRef: 'HLS 2nd Ed: Appendices A, B, C',
        version: 9,
        isDynamic: true,
        complexityScore: 5,
    },
    {
        name: 'Playlist Delta Updates',
        category: 'Live & Dynamic',
        desc: 'The server can provide partial playlist updates using the #EXT-X-SKIP tag, reducing download size for live streams.',
        isoRef: 'HLS 2nd Ed: 4.4.5.2, 6.2.5.1',
        version: 9,
        isDynamic: true,
        complexityScore: 4,
    },
    {
        name: 'Variable Substitution',
        category: 'Live & Dynamic',
        desc: 'Uses #EXT-X-DEFINE to create playlist variables, allowing for dynamic generation of URIs and attributes.',
        isoRef: 'HLS 2nd Ed: 4.4.2.3',
        version: 8,
        complexityScore: 3,
    },
    {
        name: 'Content Steering',
        category: 'Live & Dynamic',
        desc: 'Provides a mechanism for servers to steer clients to alternate servers for redundancy and load balancing.',
        isoRef: 'HLS 2nd Ed: 4.4.6.6',
        version: 11,
        isDynamic: true,
        complexityScore: 4,
    },
    {
        name: 'I-Frame Playlists',
        category: 'Advanced Content',
        desc: 'Provides special, I-Frame only playlists to enable efficient fast-forward and rewind.',
        isoRef: 'HLS 2nd Ed: 4.4.6.3',
        version: 4,
        complexityScore: 3,
    },
    {
        name: 'Advanced Metadata & Rendition Selection',
        category: 'Advanced Content',
        desc: 'Utilizes advanced attributes (e.g., SCORE, STABLE-VARIANT-ID) to provide richer context for client ABR logic.',
        isoRef: 'HLS 2nd Ed: Appendices D, G',
        version: 9,
        isDynamic: true,
        complexityScore: 3,
    },
    {
        name: 'Immersive Video (REQ-VIDEO-LAYOUT)',
        category: 'Advanced Content',
        desc: 'Specifies video projection for immersive experiences (e.g., equirectangular, Apple Immersive Video).',
        isoRef: 'HLS 2nd Ed: 4.4.6.2',
        version: 12,
        complexityScore: 5,
    },
    {
        name: 'Generalized INSTREAM-ID',
        category: 'Advanced Content',
        desc: 'Allows INSTREAM-ID to be used for all media types, not just closed captions, for identifying tracks within a segment.',
        isoRef: 'HLS 2nd Ed: 4.4.6.1',
        version: 13,
        complexityScore: 4,
    },
    {
        name: 'Session Data',
        category: 'Client Guidance & Optimization',
        desc: 'The multivariant playlist carries arbitrary session data using #EXT-X-SESSION-DATA.',
        isoRef: 'HLS 2nd Ed: 4.4.6.4',
        version: 1,
        complexityScore: 1,
    },
    {
        name: 'Start Offset',
        category: 'Client Guidance & Optimization',
        desc: 'The playlist uses #EXT-X-START to indicate a preferred starting point.',
        isoRef: 'HLS 2nd Ed: 4.4.2.2',
        version: 1,
        complexityScore: 2,
    },
    {
        name: 'Bitrate Hinting',
        category: 'Client Guidance & Optimization',
        desc: 'Provides the approximate segment bit rate of media segments using the EXT-X-BITRATE tag.',
        isoRef: 'HLS 2nd Ed: 4.4.4.8',
        version: 8,
        isDynamic: true,
        complexityScore: 2,
    },
    {
        name: 'HDCP Level',
        category: 'Client Guidance & Optimization',
        desc: 'Advises that the Variant Stream may fail to play unless the output is protected by HDCP.',
        isoRef: 'HLS 2nd Ed: 4.4.6.2',
        version: 1,
        complexityScore: 2,
    },
    {
        name: 'Stable Variant/Rendition IDs',
        category: 'Client Guidance & Optimization',
        desc: 'Provides stable identifiers for Variant Streams and Renditions, allowing their URIs to change between playlist reloads.',
        isoRef: 'HLS 2nd Ed: 4.4.6.1, 4.4.6.2',
        version: 10,
        complexityScore: 3,
    },
    {
        name: 'Alternative Renditions',
        category: 'Accessibility & Metadata',
        desc: 'Uses #EXT-X-MEDIA to provide alternative tracks for language, commentary, or camera angles.',
        isoRef: 'HLS 2nd Ed: 4.4.6.1',
        version: 4,
        complexityScore: 2,
    },
    {
        name: 'Associated Language',
        category: 'Accessibility & Metadata',
        desc: 'The ASSOC-LANGUAGE attribute links renditions with different roles, like spoken vs. written language.',
        isoRef: 'HLS 2nd Ed: 4.4.6.1',
        version: 4,
        complexityScore: 2,
    },
    {
        name: 'Forced Subtitles',
        category: 'Accessibility & Metadata',
        desc: 'The FORCED=YES attribute on a SUBTITLES rendition indicates content considered essential to play (e.g., translating foreign dialogue).',
        isoRef: 'HLS 2nd Ed: 4.4.6.1',
        version: 4,
        complexityScore: 2,
    },
    {
        name: 'Rendition Characteristics',
        category: 'Accessibility & Metadata',
        desc: 'The CHARACTERISTICS attribute provides detailed properties of a rendition (e.g., for accessibility).',
        isoRef: 'HLS 2nd Ed: 4.4.6.1',
        version: 4,
        complexityScore: 2,
    },
    {
        name: 'Machine-Generated Content Flag',
        category: 'Accessibility & Metadata',
        desc: 'The "public.machine-generated" characteristic indicates a rendition was authored or translated programmatically.',
        isoRef: 'HLS 2nd Ed: 4.4.6.1',
        version: 13,
        complexityScore: 3,
    },
    {
        name: 'Subtitles & Captions',
        category: 'Accessibility & Metadata',
        desc: 'Provides text-based tracks for subtitles or closed captions via #EXT-X-MEDIA.',
        isoRef: 'HLS 2nd Ed: 4.4.6.1',
        version: 4,
        complexityScore: 2,
    },
    {
        name: 'Advanced Spatial Audio (CHANNELS)',
        category: 'Accessibility & Metadata',
        desc: 'Provides enhanced descriptors for spatial audio, including channel beds (BED-*) and degrees of freedom (DOF-*).',
        isoRef: 'HLS 2nd Ed: 4.4.6.1',
        version: 13,
        complexityScore: 4,
    },
    {
        name: 'Video Range (SDR/PQ/HLG)',
        category: 'Accessibility & Metadata',
        desc: 'Specifies the dynamic range of the video content using the VIDEO-RANGE attribute.',
        isoRef: 'HLS 2nd Ed: 4.4.6.2',
        version: 9,
        complexityScore: 3,
    },
];
